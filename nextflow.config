/*
 * Nextflow Configuration File
 * Temperature Adaptation Pipeline
 */

// Pipeline parameters
params {
    // Input data
    input_csv = "${projectDir}/data/bacdrive.csv"

    // Rfam database URLs
    rfam_cm_url = "https://ftp.ebi.ac.uk/pub/databases/Rfam/CURRENT/Rfam.cm.gz"
    rfam_clanin_url = "https://ftp.ebi.ac.uk/pub/databases/Rfam/CURRENT/Rfam.clanin"

    // Output directory
    outdir = "results"

    // For testing: limit number of genomes to process
    max_genomes = 1

    // Help message
    help = false
}

// Process configuration
process {
    // No default container - set per profile
}

// Execution configuration
executor {
    name = 'local'
    cpus = 8
    memory = '16 GB'
}

// Enable trace and timeline reports
trace {
    enabled = true
    file = "${params.outdir}/trace.txt"
    overwrite = true
}

timeline {
    enabled = true
    file = "${params.outdir}/timeline.html"
    overwrite = true
}

report {
    enabled = true
    file = "${params.outdir}/report.html"
    overwrite = true
}

// Manifest
manifest {
    name = 'temperature-adapt'
    author = 'Your Name'
    description = 'Pipeline for analyzing bacterial temperature adaptation using Rfam'
    mainScript = 'main.nf'
    version = '0.1.0'
}

// Profiles for different execution environments
profiles {
    standard {
        process.executor = 'local'
    }

    docker {
        docker.enabled = true
        docker.runOptions = '-u $(id -u):$(id -g)'
        process.container = 'temperature-adapt:latest'
    }

    singularity {
        singularity.enabled = true
        singularity.autoMounts = true
        process.container = 'docker://temperature-adapt:latest'
    }

    slurm {
        process.executor = 'slurm'
        process.queue = 'batch'
        singularity.enabled = true
        singularity.autoMounts = true
        process.container = 'docker://temperature-adapt:latest'
    }

    test {
        params.max_genomes = 1
    }

    production {
        params.max_genomes = null  // Process all genomes
    }
}
